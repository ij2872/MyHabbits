@{
    ViewBag.Title = "Edit";
}
<h2>@ViewBag.Title.</h2>
<h3>@ViewBag.Message</h3>

<div class="container">
    @{
            int i = 0;
            foreach (var task in Model.CustomerTasks)
            {
            <div class="row edit-container" id='@i'>
                <div class="col-sm-10 edit-task">@task.Title</div>
                <button type="button" class="btn btn-danger edit-delete" data-div-id='@i' data-title='@task.Title' data-id='@task.Id'>Delete</button>
            </div>
            i++;
        }
    }
</div>


@section scripts{
    <script src="~/Scripts/bootbox.min.js"></script>
    <script>
        $(document).ready(function () {
            $('.edit-delete').on("click", function () {
                var title = $(this).data('title');
                var id = $(this).data('id');
                var divIdToDelete = $(this).data('div-id');
                
                //create CustomerTask Object
                var customerTask = {
                    "Title": title,
                    "Id": id,
                };
                console.log(customerTask.Id);

                bootbox.confirm("Are you sure you want to delete " + title + "?" , function (result) {
                    if (result) {
                        $.ajax({
                            url: "/Home/Edit/",
                            method: "DELETE",
                            data: customerTask,
                            success: function (res) {
                                console.log("success: " + res);
                                $('#' + divIdToDelete).remove();
                            },
                            error: function (res) {
                                console.log("Error: " + res);
                                location.reload();
                            }
                        });
                    }
                });

            });
        });
    </script>   
}